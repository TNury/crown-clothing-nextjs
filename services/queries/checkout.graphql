fragment CheckoutProps on Checkout {
  id
  lineItems(first: 10) {
    nodes {
      id
      quantity
      title
      unitPrice {
        amount
      }
      variant {
        ... on ProductVariant {
          id
          image {
            url
            altText
          }
          price {
            amount
          }
          product {
            title
          }
        }
      }
    }
  }
  totalTax {
    amount
  }
  totalPrice {
    amount
  }
  lineItemsSubtotalPrice {
    amount
  }
  email
  shippingAddress {
    address1
    address2
    city
    country
    firstName
    lastName
    phone
    zip
    province
  }
}

mutation createCheckout($input: CheckoutCreateInput!) {
  checkoutCreate(input: $input) {
    checkout {
      ...CheckoutProps
    }
    checkoutUserErrors {
      field
      code
      message
    }
    userErrors {
      field
      message
    }
  }
}

mutation updateCheckoutShippingAddress(
  $checkoutId: ID!
  $input: MailingAddressInput!
) {
  checkoutShippingAddressUpdateV2(
    checkoutId: $checkoutId
    shippingAddress: $input
  ) {
    checkout {
      ...CheckoutProps
    }
    checkoutUserErrors {
      field
      code
      message
    }
    userErrors {
      field
      message
    }
  }
}

mutation updateCheckoutContactEmail($checkoutId: ID!, $input: String!) {
  checkoutEmailUpdateV2(checkoutId: $checkoutId, email: $input) {
    checkout {
      ...CheckoutProps
    }
    checkoutUserErrors {
      field
      code
      message
    }
    userErrors {
      field
      message
    }
  }
}

# WE MUST MAKE THIS DYNAMIC
mutation completeCheckout($checkoutId: ID!, $paymentData: String!) {
  checkoutCompleteWithTokenizedPaymentV3(
    checkoutId: $checkoutId
    payment: {
      type: STRIPE_VAULT_TOKEN
      paymentAmount: { amount: "120", currencyCode: BRL }
      idempotencyKey: "placeholder_1234"
      billingAddress: {
        firstName: "Yuri",
        lastName: "Pereira",
        address1: "Estudante Idalvo 67",
        address2: "",
        zip: "58057450",
        city: "João Pessoa",
        province: "Paraíba",
        country: "BR",
        phone: "+55 83 981264559",
      }
      test: true,
      paymentData: $paymentData
    }
  ) {
    checkout {
      id
    }
    payment {
      id
    }
    checkoutUserErrors {
      field
      code
      message
    }
    userErrors {
      field
      message
    }
  }
}
